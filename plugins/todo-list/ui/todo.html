<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Todo List</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        /* Áé∞‰ª£ÈÖçËâ≤ÊñπÊ°à - ÊüîÂíå‰∏ì‰∏ö */
        --color-primary: #6366f1;
        --color-primary-light: #818cf8;
        --color-primary-dark: #4f46e5;
        --color-bg: #fafbfc;
        --color-surface: #ffffff;
        --color-surface-hover: #f8f9fa;
        --color-border: #e5e7eb;
        --color-border-light: #f3f4f6;
        --color-text: #1f2937;
        --color-text-secondary: #6b7280;
        --color-text-muted: #9ca3af;

        /* ‰ºòÂÖàÁ∫ßÈ¢úËâ≤ - ÊüîÂíåÁâàÊú¨ */
        --color-priority-high: #ef4444;
        --color-priority-high-light: #fee2e2;
        --color-priority-medium: #f59e0b;
        --color-priority-medium-light: #fef3c7;
        --color-priority-low: #10b981;
        --color-priority-low-light: #d1fae5;

        /* Èò¥ÂΩ± */
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);

        /* Èó¥Ë∑ùÁ≥ªÁªü */
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;

        /* ÂúÜËßí */
        --radius-sm: 0.375rem;
        --radius-md: 0.5rem;
        --radius-lg: 0.75rem;
        --radius-xl: 1rem;
      }

      body {
        font-family:
          -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell',
          'Helvetica Neue', Arial, sans-serif;
        background: var(--color-bg);
        min-height: 100vh;
        height: 100vh;
        padding: var(--space-6);
        overflow-x: hidden;
        color: var(--color-text);
        line-height: 1.6;
        display: flex;
        flex-direction: column;
      }

      #app {
        max-width: 900px;
        margin: 0 auto;
        width: 100%;
        flex: 1;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
      }

      /* Â§¥ÈÉ®Âå∫Âüü - Á¥ßÂáë‰ºòÂåñ */
      .header {
        flex-shrink: 0;
        background: var(--color-surface);
        border-radius: var(--radius-xl);
        padding: var(--space-5) var(--space-6);
        margin-bottom: var(--space-4);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--color-border-light);
      }

      .header-top {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-5);
      }

      .header-title {
        display: flex;
        align-items: center;
        gap: var(--space-3);
      }

      .header-icon {
        width: 36px;
        height: 36px;
        background: linear-gradient(
          135deg,
          var(--color-primary) 0%,
          var(--color-primary-dark) 100%
        );
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        box-shadow: var(--shadow-sm);
      }

      h1 {
        font-size: 24px;
        font-weight: 700;
        color: var(--color-text);
        letter-spacing: -0.02em;
      }

      .stats {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: var(--space-4);
        padding: var(--space-4) 0 0 0;
        border-top: 1px solid var(--color-border-light);
      }

      .stat-item {
        text-align: center;
        position: relative;
      }

      .stat-item:not(:last-child)::after {
        content: '';
        position: absolute;
        right: calc(var(--space-4) / -2);
        top: 50%;
        transform: translateY(-50%);
        width: 1px;
        height: 24px;
        background: var(--color-border-light);
      }

      .stat-value {
        font-size: 24px;
        font-weight: 700;
        color: var(--color-primary);
        margin-bottom: var(--space-1);
        line-height: 1;
        letter-spacing: -0.03em;
      }

      .stat-label {
        font-size: 12px;
        color: var(--color-text-secondary);
        font-weight: 500;
        letter-spacing: 0.02em;
      }

      /* ËøáÊª§Âô®ÂíåÊìç‰ΩúÊ†è - ÊûÅÁÆÄËÆæËÆ° */
      .filters {
        flex-shrink: 0;
        background: var(--color-surface);
        border-radius: var(--radius-xl);
        padding: var(--space-3) var(--space-4);
        margin-bottom: var(--space-4);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--color-border-light);
        display: flex;
        gap: var(--space-4);
        flex-wrap: wrap;
        align-items: center;
      }

      .filter-group {
        display: flex;
        gap: var(--space-2);
        background: var(--color-bg);
        padding: var(--space-1);
        border-radius: var(--radius-lg);
      }

      .filter-btn {
        padding: var(--space-2) var(--space-4);
        border: none;
        background: transparent;
        border-radius: var(--radius-md);
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        color: var(--color-text-secondary);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .filter-btn.active {
        background: var(--color-primary);
        color: white;
        box-shadow: var(--shadow-sm);
      }

      .filter-btn:hover:not(.active) {
        background: var(--color-surface-hover);
        color: var(--color-text);
      }

      /* ÊêúÁ¥¢Ê°ÜÂíåÊ∑ªÂä†ÊåâÈíÆÁªÑÂêà */
      .search-and-add {
        flex: 1;
        display: flex;
        gap: var(--space-3);
        align-items: center;
        min-width: 300px;
      }

      .search-box {
        flex: 1;
        min-width: 180px;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: var(--space-3) var(--space-4) var(--space-3) 36px;
        border: 1px solid var(--color-border);
        background: var(--color-bg);
        border-radius: var(--radius-lg);
        font-size: 14px;
        color: var(--color-text);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .search-input::placeholder {
        color: var(--color-text-muted);
      }

      .search-input:focus {
        outline: none;
        border-color: var(--color-primary);
        background: var(--color-surface);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .search-icon {
        position: absolute;
        left: var(--space-3);
        top: 50%;
        transform: translateY(-50%);
        color: var(--color-text-muted);
        font-size: 16px;
      }

      /* Ê∑ªÂä†‰ªªÂä°ÊåâÈíÆ - Áé∞‰ª£ÁÆÄÁ∫¶ */
      .add-todo-btn {
        padding: var(--space-3) var(--space-5);
        background: var(--color-surface);
        color: var(--color-primary);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
        box-shadow: var(--shadow-sm);
        white-space: nowrap;
        flex-shrink: 0;
      }

      .add-todo-btn:hover {
        background: var(--color-primary);
        color: white;
        border-color: var(--color-primary);
        box-shadow: var(--shadow-md);
        transform: translateY(-1px);
      }

      .add-todo-btn:active {
        transform: translateY(0);
      }

      .add-icon {
        font-size: 16px;
      }

      /* Dialog ÂºπÁ™óÊ†∑Âºè */
      .add-dialog {
        border: none;
        border-radius: var(--radius-xl);
        padding: 0;
        max-width: 500px;
        width: 90%;
        box-shadow: var(--shadow-xl);
        background: transparent;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        margin: 0;
      }

      .add-dialog::backdrop {
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
      }

      .dialog-content {
        background: var(--color-surface);
        border-radius: var(--radius-xl);
        overflow: hidden;
      }

      .dialog-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--space-6);
        border-bottom: 1px solid var(--color-border-light);
      }

      .dialog-title {
        font-size: 20px;
        font-weight: 700;
        color: var(--color-text);
        margin: 0;
      }

      .dialog-close {
        width: 32px;
        height: 32px;
        border: none;
        background: var(--color-bg);
        color: var(--color-text-secondary);
        border-radius: var(--radius-md);
        cursor: pointer;
        font-size: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .dialog-close:hover {
        background: var(--color-priority-high);
        color: white;
      }

      .dialog-body {
        padding: var(--space-6);
      }

      .form-group {
        margin-bottom: var(--space-5);
      }

      .form-group:last-child {
        margin-bottom: 0;
      }

      .form-label {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        font-size: 14px;
        font-weight: 600;
        color: var(--color-text);
        margin-bottom: var(--space-3);
      }

      .label-icon {
        font-size: 14px;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--space-4);
      }

      .form-input {
        width: 100%;
        padding: var(--space-3) var(--space-4);
        border: 1px solid var(--color-border);
        background: var(--color-bg);
        border-radius: var(--radius-lg);
        font-size: 15px;
        color: var(--color-text);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        font-weight: 400;
      }

      .form-input::placeholder {
        color: var(--color-text-muted);
      }

      .form-input:focus {
        outline: none;
        border-color: var(--color-primary);
        background: var(--color-surface);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .form-date {
        cursor: pointer;
      }

      .form-textarea {
        width: 100%;
        padding: var(--space-3) var(--space-4);
        border: 1px solid var(--color-border);
        background: var(--color-bg);
        border-radius: var(--radius-lg);
        font-size: 14px;
        color: var(--color-text);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        font-family: inherit;
        resize: vertical;
        min-height: 80px;
        line-height: 1.6;
      }

      .form-textarea::placeholder {
        color: var(--color-text-muted);
      }

      .form-textarea:focus {
        outline: none;
        border-color: var(--color-primary);
        background: var(--color-surface);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .priority-selector {
        display: flex;
        gap: var(--space-2);
      }

      .priority-btn {
        flex: 1;
        padding: var(--space-2) var(--space-3);
        border: 1px solid var(--color-border);
        background: var(--color-surface);
        border-radius: var(--radius-md);
        cursor: pointer;
        font-size: 13px;
        font-weight: 500;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--space-2);
      }

      .priority-btn:hover:not(.active) {
        background: var(--color-surface-hover);
        border-color: var(--color-text-muted);
      }

      /* È´ò‰ºòÂÖàÁ∫ßÊåâÈíÆ */
      .priority-btn.high {
        color: var(--color-priority-high);
      }

      .priority-btn.high.active {
        background: var(--color-priority-high);
        border-color: var(--color-priority-high);
        color: white;
        box-shadow: var(--shadow-sm);
      }

      /* ‰∏≠‰ºòÂÖàÁ∫ßÊåâÈíÆ */
      .priority-btn.medium {
        color: var(--color-priority-medium);
      }

      .priority-btn.medium.active {
        background: var(--color-priority-medium);
        border-color: var(--color-priority-medium);
        color: white;
        box-shadow: var(--shadow-sm);
      }

      /* ‰Ωé‰ºòÂÖàÁ∫ßÊåâÈíÆ */
      .priority-btn.low {
        color: var(--color-priority-low);
      }

      .priority-btn.low.active {
        background: var(--color-priority-low);
        border-color: var(--color-priority-low);
        color: white;
        box-shadow: var(--shadow-sm);
      }

      .dialog-footer {
        display: flex;
        justify-content: flex-end;
        gap: var(--space-3);
        padding: var(--space-5) var(--space-6);
        border-top: 1px solid var(--color-border-light);
        background: var(--color-bg);
      }

      .dialog-btn {
        padding: var(--space-3) var(--space-5);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .dialog-btn-cancel {
        background: var(--color-surface);
        color: var(--color-text-secondary);
      }

      .dialog-btn-cancel:hover {
        background: var(--color-surface-hover);
        border-color: var(--color-border);
      }

      .dialog-btn-primary {
        background: var(--color-primary);
        color: white;
        border-color: var(--color-primary);
        box-shadow: var(--shadow-sm);
      }

      .dialog-btn-primary:hover:not(:disabled) {
        background: var(--color-primary-dark);
        box-shadow: var(--shadow-md);
      }

      .dialog-btn-primary:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      /* ÂæÖÂäûÂàóË°® - Á≤æËá¥Âç°Áâá */
      .todo-list {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
        overflow-y: auto;
      }

      .todo-item {
        background: var(--color-surface);
        border-radius: var(--radius-lg);
        padding: var(--space-4) var(--space-5);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--color-border-light);
        display: flex;
        align-items: center;
        gap: var(--space-4);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .todo-item:hover {
        box-shadow: var(--shadow-md);
        border-color: var(--color-border);
      }

      .todo-item.completed {
        opacity: 0.6;
        background: var(--color-bg);
      }

      /* Áé∞‰ª£Âåñ Checkbox */
      .todo-checkbox {
        width: 22px;
        height: 22px;
        border: 2px solid var(--color-border);
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--color-surface);
        position: relative;
      }

      .todo-checkbox:hover {
        border-color: var(--color-primary);
        background: rgba(99, 102, 241, 0.05);
        transform: scale(1.1);
      }

      .todo-checkbox.checked {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        border-color: #6366f1;
        animation: checkBounce 0.3s ease;
      }

      @keyframes checkBounce {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
      }

      .todo-checkbox.checked::after {
        content: '';
        position: absolute;
        width: 5px;
        height: 10px;
        border: solid white;
        border-width: 0 2px 2px 0;
        transform: rotate(45deg);
        animation: checkMark 0.3s ease 0.1s both;
      }

      @keyframes checkMark {
        0% {
          height: 0;
          width: 0;
          opacity: 0;
        }
        20% {
          height: 0;
          width: 5px;
          opacity: 1;
        }
        40% {
          height: 10px;
          width: 5px;
          opacity: 1;
        }
        100% {
          height: 10px;
          width: 5px;
          opacity: 1;
        }
      }

      .priority-indicator {
        width: 3px;
        height: 32px;
        border-radius: 99px;
        flex-shrink: 0;
      }

      .priority-indicator.high {
        background: var(--color-priority-high);
      }

      .priority-indicator.medium {
        background: var(--color-priority-medium);
      }

      .priority-indicator.low {
        background: var(--color-priority-low);
      }

      .todo-content {
        flex: 1;
        min-width: 0;
      }

      .todo-text {
        font-size: 15px;
        color: var(--color-text);
        margin-bottom: var(--space-2);
        word-break: break-word;
        line-height: 1.6;
        font-weight: 400;
      }

      .todo-item.completed .todo-text {
        text-decoration: line-through;
        color: var(--color-text-muted);
      }

      /* Â§áÊ≥® - Á¥ßÂáëÂçïË°åËÆæËÆ° */
      .todo-notes {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        margin-bottom: var(--space-2);
        padding: var(--space-2) var(--space-3);
        background: var(--color-bg);
        border-radius: var(--radius-md);
        font-size: 13px;
        color: var(--color-text-secondary);
        line-height: 1.5;
        border-left: 2px solid var(--color-border);
      }

      .notes-icon {
        font-size: 14px;
        flex-shrink: 0;
        opacity: 0.7;
      }

      .notes-text {
        flex: 1;
        font-style: italic;
      }

      .todo-item.completed .todo-notes {
        opacity: 0.5;
      }

      /* ÂÖÉ‰ø°ÊÅØË°å - ÊâÄÊúâÊ†áÁ≠æÂú®‰∏ÄË°å */
      .todo-meta {
        font-size: 12px;
        color: var(--color-text-secondary);
        display: flex;
        align-items: center;
        gap: var(--space-3);
        flex-wrap: wrap;
      }

      /* Êà™Ê≠¢Êó•ÊúüÊ†áÁ≠æ - Á¥ßÂáëinlineËÆæËÆ° */
      .due-date-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 2px 8px;
        border-radius: var(--radius-md);
        font-size: 12px;
        font-weight: 500;
        transition: all 0.2s;
      }

      .badge-icon {
        font-size: 11px;
      }

      /* ÈªòËÆ§Áä∂ÊÄÅ - ÁÅ∞Ëâ≤ */
      .due-date-badge {
        background: var(--color-bg);
        color: var(--color-text-secondary);
        border: 1px solid var(--color-border-light);
      }

      /* Â∑≤ËøáÊúü - Á∫¢Ëâ≤ */
      .due-date-badge.overdue {
        background: rgba(239, 68, 68, 0.08);
        border-color: rgba(239, 68, 68, 0.2);
        color: #dc2626;
      }

      /* ‰ªäÂ§©Âà∞Êúü - Ê©ôËâ≤ */
      .due-date-badge.today {
        background: rgba(251, 191, 36, 0.08);
        border-color: rgba(251, 191, 36, 0.2);
        color: #f59e0b;
      }

      /* Âç≥Â∞ÜÂà∞Êúü - ËìùËâ≤ */
      .due-date-badge.upcoming {
        background: rgba(99, 102, 241, 0.08);
        border-color: rgba(99, 102, 241, 0.2);
        color: var(--color-primary);
      }

      .create-time {
        color: var(--color-text-muted);
        font-size: 11px;
      }

      /* ‰ºòÂÖàÁ∫ßÊ†áÁ≠æ - Áé∞‰ª£ÂåñËÆæËÆ° */
      .priority-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 3px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .priority-badge::before {
        content: '';
        width: 6px;
        height: 6px;
        border-radius: 50%;
        flex-shrink: 0;
      }

      .priority-badge.high {
        background: rgba(239, 68, 68, 0.1);
        color: #dc2626;
      }

      .priority-badge.high::before {
        background: #dc2626;
        box-shadow: 0 0 4px rgba(239, 68, 68, 0.4);
      }

      .priority-badge.medium {
        background: rgba(99, 102, 241, 0.1);
        color: #6366f1;
      }

      .priority-badge.medium::before {
        background: #6366f1;
        box-shadow: 0 0 4px rgba(99, 102, 241, 0.4);
      }

      .priority-badge.low {
        background: rgba(156, 163, 175, 0.1);
        color: #6b7280;
      }

      .priority-badge.low::before {
        background: #9ca3af;
      }

      .todo-actions {
        display: flex;
        gap: var(--space-2);
        opacity: 0;
        transition: opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .todo-item:hover .todo-actions {
        opacity: 1;
      }

      /* Áé∞‰ª£ÂõæÊ†áÊåâÈíÆ */
      .action-btn {
        width: 32px;
        height: 32px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: none;
        background: transparent;
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        color: var(--color-text-secondary);
        position: relative;
      }

      .action-btn:hover {
        background: var(--color-bg);
        transform: scale(1.1);
      }

      .action-btn.edit:hover {
        background: rgba(99, 102, 241, 0.1);
        color: var(--color-primary);
      }

      .action-btn.delete:hover {
        background: rgba(239, 68, 68, 0.1);
        color: var(--color-danger);
      }

      /* SVG ÂõæÊ†áÊ†∑Âºè */
      .action-btn svg {
        width: 16px;
        height: 16px;
        stroke-width: 2;
      }

      /* Tooltip */
      .action-btn::before {
        content: attr(aria-label);
        position: absolute;
        top: -30px;
        left: 50%;
        transform: translateX(-50%) scale(0);
        padding: 4px 8px;
        background: rgba(0, 0, 0, 0.8);
        color: white;
        font-size: 11px;
        border-radius: 4px;
        white-space: nowrap;
        pointer-events: none;
        opacity: 0;
        transition: all 0.2s;
      }

      .action-btn:hover::before {
        transform: translateX(-50%) scale(1);
        opacity: 1;
      }

      /* Á©∫Áä∂ÊÄÅ - ‰ºòÈõÖËÆæËÆ° */
      .empty-state {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: var(--space-8) var(--space-6);
        background: var(--color-surface);
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--color-border-light);
        min-height: 400px;
      }

      .empty-icon {
        font-size: 72px;
        margin-bottom: var(--space-4);
        opacity: 0.6;
        filter: grayscale(0.2);
      }

      .empty-text {
        font-size: 18px;
        color: var(--color-text);
        margin-bottom: var(--space-2);
        font-weight: 600;
      }

      .empty-hint {
        font-size: 14px;
        color: var(--color-text-secondary);
      }

      /* Â∫ïÈÉ®Êìç‰ΩúÊ†è - ÁÆÄÊ¥ÅÂ∏ÉÂ±Ä */
      .footer {
        flex-shrink: 0;
        background: var(--color-surface);
        border-radius: var(--radius-xl);
        padding: var(--space-4) var(--space-5);
        margin-top: var(--space-4);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--color-border-light);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .footer-info {
        font-size: 14px;
        color: var(--color-text-secondary);
        font-weight: 500;
      }

      .footer-actions {
        display: flex;
        gap: var(--space-3);
      }

      .footer-btn {
        padding: var(--space-3) var(--space-5);
        border: 1px solid var(--color-border);
        background: var(--color-surface);
        border-radius: var(--radius-lg);
        cursor: pointer;
        font-size: 13px;
        font-weight: 500;
        color: var(--color-priority-high);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .footer-btn:hover:not(:disabled) {
        background: var(--color-priority-high);
        border-color: var(--color-priority-high);
        color: white;
        box-shadow: var(--shadow-sm);
      }

      .footer-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
      }

      /* ÁºñËæëÊ®°Âºè - Ê∏ÖÊô∞ÂèçÈ¶à */
      .edit-input {
        width: 100%;
        padding: var(--space-2) var(--space-4);
        border: 2px solid var(--color-primary);
        background: var(--color-surface);
        border-radius: var(--radius-md);
        font-size: 15px;
        font-family: inherit;
        color: var(--color-text);
      }

      .edit-input:focus {
        outline: none;
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      /* Âä†ËΩΩÁä∂ÊÄÅ - ‰ºòÈõÖÂä®Áîª */
      .loading {
        text-align: center;
        padding: var(--space-8);
        color: var(--color-text-secondary);
        font-size: 16px;
        font-weight: 500;
      }

      /* ÂìçÂ∫îÂºèËÆæËÆ° */
      @media (max-width: 768px) {
        body {
          padding: var(--space-4);
          height: auto;
          min-height: 100vh;
        }

        .header {
          padding: var(--space-4) var(--space-5);
        }

        h1 {
          font-size: 20px;
        }

        .header-icon {
          width: 32px;
          height: 32px;
          font-size: 18px;
        }

        .stats {
          grid-template-columns: repeat(2, 1fr);
          gap: var(--space-3);
        }

        .stat-item:nth-child(2n)::after {
          display: none;
        }

        .stat-value {
          font-size: 20px;
        }

        .filters {
          flex-direction: column;
        }

        .filter-group {
          width: 100%;
        }

        .search-and-add {
          width: 100%;
          min-width: 0;
          flex-direction: column;
        }

        .search-box {
          width: 100%;
        }

        .add-todo-btn {
          width: 100%;
        }

        .todo-item {
          padding: var(--space-3) var(--space-4);
        }

        /* Dialog ÁßªÂä®Á´Ø‰ºòÂåñ */
        .add-dialog {
          max-width: 95%;
          width: 95%;
        }

        .dialog-header,
        .dialog-body,
        .dialog-footer {
          padding: var(--space-4);
        }

        .dialog-title {
          font-size: 18px;
        }

        .priority-selector {
          flex-direction: column;
        }

        .dialog-footer {
          flex-direction: column-reverse;
        }

        .dialog-btn {
          width: 100%;
        }
      }

      /* ÊªöÂä®Êù°Ê†∑Âºè - Á≤æËá¥ */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: var(--color-bg);
      }

      ::-webkit-scrollbar-thumb {
        background: var(--color-border);
        border-radius: 99px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--color-text-muted);
      }
    </style>
  </head>
  <body>
    <div id="app">
      <div v-if="loading" class="loading">Âä†ËΩΩ‰∏≠...</div>

      <template v-else>
        <!-- Â§¥ÈÉ® -->
        <div class="header">
          <div class="header-top">
            <div class="header-title">
              <div class="header-icon">‚úì</div>
              <h1>{{ pluginName }}</h1>
            </div>
          </div>

          <!-- ÁªüËÆ° -->
          <div class="stats">
            <div class="stat-item">
              <div class="stat-value">{{ totalCount }}</div>
              <div class="stat-label">ÊÄª‰ªªÂä°</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ activeCount }}</div>
              <div class="stat-label">ËøõË°å‰∏≠</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ completedCount }}</div>
              <div class="stat-label">Â∑≤ÂÆåÊàê</div>
            </div>
            <div class="stat-item">
              <div class="stat-value">{{ completionRate }}%</div>
              <div class="stat-label">ÂÆåÊàêÁéá</div>
            </div>
          </div>
        </div>

        <!-- ËøáÊª§Âô®ÂíåÊìç‰ΩúÊ†è -->
        <div class="filters">
          <div class="filter-group">
            <button
              v-for="filter in filters"
              :key="filter.value"
              :class="['filter-btn', { active: currentFilter === filter.value }]"
              @click="currentFilter = filter.value"
            >
              {{ filter.label }}
            </button>
          </div>

          <div class="search-and-add">
            <div class="search-box">
              <span class="search-icon">üîç</span>
              <input
                type="text"
                class="search-input"
                v-model="searchQuery"
                placeholder="ÊêúÁ¥¢‰ªªÂä°..."
              />
            </div>

            <button class="add-todo-btn" @click="openAddDialog">
              <span class="add-icon">‚ûï</span>
              <span>Ê∑ªÂä†‰ªªÂä°</span>
            </button>
          </div>
        </div>

        <!-- ‰ªªÂä°DialogÔºàÊ∑ªÂä†/ÁºñËæëÈÄöÁî®Ôºâ -->
        <dialog ref="todoDialog" class="add-dialog" @click="handleDialogClick">
          <div class="dialog-content">
            <div class="dialog-header">
              <h2 class="dialog-title">{{ dialogMode === 'add' ? 'Ê∑ªÂä†Êñ∞‰ªªÂä°' : 'ÁºñËæë‰ªªÂä°' }}</h2>
              <button class="dialog-close" @click="closeTodoDialog" aria-label="ÂÖ≥Èó≠">‚úï</button>
            </div>

            <div class="dialog-body">
              <div class="form-group">
                <label class="form-label">‰ªªÂä°ÂÜÖÂÆπ *</label>
                <input
                  type="text"
                  class="form-input"
                  v-model="todoText"
                  @keyup.enter="saveTodoFromDialog"
                  placeholder="ËØ∑ËæìÂÖ•‰ªªÂä°ÂÜÖÂÆπ..."
                  ref="dialogInput"
                />
              </div>

              <div class="form-group">
                <label class="form-label">‰ºòÂÖàÁ∫ß</label>
                <div class="priority-selector">
                  <button
                    v-for="p in priorities"
                    :key="p.value"
                    :class="['priority-btn', p.value, { active: todoPriority === p.value }]"
                    @click="todoPriority = p.value"
                  >
                    <span>{{ p.icon }}</span>
                    <span>{{ p.label }}</span>
                  </button>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label class="form-label">
                    <span class="label-icon">üìÖ</span>
                    <span>Êà™Ê≠¢Êó•Êúü</span>
                  </label>
                  <input
                    type="date"
                    class="form-input form-date"
                    v-model="todoDueDate"
                    :min="getTodayDate()"
                  />
                </div>
              </div>

              <div class="form-group">
                <label class="form-label">
                  <span class="label-icon">üìù</span>
                  <span>Â§áÊ≥®</span>
                </label>
                <textarea
                  class="form-textarea"
                  v-model="todoNotes"
                  placeholder="Ê∑ªÂä†Â§áÊ≥®‰ø°ÊÅØÔºàÂèØÈÄâÔºâ..."
                  rows="3"
                ></textarea>
              </div>
            </div>

            <div class="dialog-footer">
              <button class="dialog-btn dialog-btn-cancel" @click="closeTodoDialog">ÂèñÊ∂à</button>
              <button
                class="dialog-btn dialog-btn-primary"
                @click="saveTodoFromDialog"
                :disabled="!todoText.trim()"
              >
                {{ dialogMode === 'add' ? 'Ê∑ªÂä†‰ªªÂä°' : '‰øùÂ≠ò‰øÆÊîπ' }}
              </button>
            </div>
          </div>
        </dialog>

        <!-- ÂæÖÂäûÂàóË°® -->
        <div class="todo-list" v-if="filteredTodos.length > 0">
          <div
            v-for="todo in filteredTodos"
            :key="todo.id"
            :class="['todo-item', { completed: todo.completed }]"
          >
            <div
              :class="['todo-checkbox', { checked: todo.completed }]"
              @click="toggleTodo(todo.id)"
            ></div>

            <div :class="['priority-indicator', todo.priority]"></div>

            <div class="todo-content">
              <div class="todo-text">{{ todo.text }}</div>

              <!-- Â§áÊ≥®ÔºàÂ¶ÇÊûúÊúâÔºâ-->
              <div class="todo-notes" v-if="todo.notes">
                <span class="notes-icon">üí¨</span>
                <span class="notes-text">{{ todo.notes }}</span>
              </div>

              <!-- ÂÖÉ‰ø°ÊÅØË°åÔºö‰ºòÂÖàÁ∫ß + Êà™Ê≠¢Êó•Êúü + ÂàõÂª∫Êó∂Èó¥ -->
              <div class="todo-meta">
                <span :class="['priority-badge', todo.priority]"
                  >{{ getPriorityLabel(todo.priority) }}</span
                >
                <span
                  v-if="todo.dueDate"
                  :class="['due-date-badge', getDueDateClass(todo.dueDate, todo.completed)]"
                >
                  <span class="badge-icon">üìÖ</span>
                  <span>{{ formatDueDate(todo.dueDate) }}</span>
                </span>
                <span class="create-time">{{ formatDate(todo.createdAt) }}</span>
              </div>
            </div>

            <div class="todo-actions">
              <button class="action-btn edit" @click="openEditDialog(todo)" aria-label="ÁºñËæë‰ªªÂä°">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"
                  />
                </svg>
              </button>
              <button class="action-btn delete" @click="deleteTodo(todo.id)" aria-label="Âà†Èô§‰ªªÂä°">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"
                  />
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- Á©∫Áä∂ÊÄÅ -->
        <div class="empty-state" v-else>
          <div class="empty-icon">üìù</div>
          <div class="empty-text">{{ emptyMessage }}</div>
          <div class="empty-hint">Ê∑ªÂä†‰Ω†ÁöÑÁ¨¨‰∏Ä‰∏™‰ªªÂä°ÂºÄÂßãÂêßÔºÅ</div>
        </div>

        <!-- Â∫ïÈÉ® -->
        <div class="footer" v-if="totalCount > 0">
          <div class="footer-info">{{ filteredTodos.length }} ‰∏™‰ªªÂä°</div>
          <div class="footer-actions">
            <button class="footer-btn" @click="clearCompleted" v-if="completedCount > 0">
              üóëÔ∏è Ê∏ÖÁ©∫Â∑≤ÂÆåÊàê ({{ completedCount }})
            </button>
          </div>
        </div>
      </template>
    </div>

    <!-- ÂºïÂÖ• Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script>
      const { createApp, ref, computed, reactive, onMounted, nextTick, watch } = Vue

      createApp({
        setup() {
          // Áä∂ÊÄÅ
          const pluginId = ref('')
          const pluginName = ref('Todo List')
          const loading = ref(true)
          const todos = ref([])
          const currentFilter = ref('all')
          const searchQuery = ref('')

          // DialogÁä∂ÊÄÅÔºàÊ∑ªÂä†/ÁºñËæëÈÄöÁî®Ôºâ
          const dialogMode = ref('add') // 'add' Êàñ 'edit'
          const editingTodoId = ref(null)
          const todoText = ref('')
          const todoPriority = ref('medium')
          const todoDueDate = ref('')
          const todoNotes = ref('')
          const todoDialog = ref(null)
          const dialogInput = ref(null)

          let saveTimer = null
          let isSaving = false // Èò≤Ê≠¢Âπ∂Âèë‰øùÂ≠ò

          // ËøáÊª§Âô®ÈÄâÈ°π
          const filters = [
            { value: 'all', label: 'ÂÖ®ÈÉ®' },
            { value: 'active', label: 'ËøõË°å‰∏≠' },
            { value: 'completed', label: 'Â∑≤ÂÆåÊàê' }
          ]

          // ‰ºòÂÖàÁ∫ßÈÄâÈ°π
          const priorities = [
            { value: 'high', label: 'È´ò‰ºòÂÖàÁ∫ß', icon: '‚ö°' },
            { value: 'medium', label: '‰∏≠‰ºòÂÖàÁ∫ß', icon: '‚óè' },
            { value: 'low', label: '‰Ωé‰ºòÂÖàÁ∫ß', icon: '‚óã' }
          ]

          // ËÆ°ÁÆóÂ±ûÊÄß
          const totalCount = computed(() => todos.value.length)

          const activeCount = computed(() => todos.value.filter((t) => !t.completed).length)

          const completedCount = computed(() => todos.value.filter((t) => t.completed).length)

          const completionRate = computed(() => {
            if (totalCount.value === 0) return 0
            return Math.round((completedCount.value / totalCount.value) * 100)
          })

          const filteredTodos = computed(() => {
            let result = todos.value

            // ÊåâÁä∂ÊÄÅËøáÊª§
            if (currentFilter.value === 'active') {
              result = result.filter((t) => !t.completed)
            } else if (currentFilter.value === 'completed') {
              result = result.filter((t) => t.completed)
            }

            // ÊêúÁ¥¢ËøáÊª§
            if (searchQuery.value.trim()) {
              const query = searchQuery.value.toLowerCase()
              result = result.filter((t) => t.text.toLowerCase().includes(query))
            }

            return result
          })

          const emptyMessage = computed(() => {
            if (searchQuery.value.trim()) {
              return 'Ê≤°ÊúâÊâæÂà∞ÂåπÈÖçÁöÑ‰ªªÂä°'
            }
            if (currentFilter.value === 'active') {
              return 'Ê≤°ÊúâËøõË°å‰∏≠ÁöÑ‰ªªÂä°'
            }
            if (currentFilter.value === 'completed') {
              return 'ËøòÊ≤°ÊúâÂÆåÊàêÁöÑ‰ªªÂä°'
            }
            return 'ËøòÊ≤°Êúâ‰ªªÂä°'
          })

          // ÁîüÂëΩÂë®Êúü
          onMounted(async () => {
            await loadData()

            // Êï∞ÊçÆÂä†ËΩΩÂÆåÊàêÂêéÔºåËÆæÁΩÆ watch ÁõëÂê¨ÂêéÁª≠ÂèòÂåñÔºàÈò≤Êäñ‰øùÂ≠òÔºâ
            watch(
              todos,
              () => {
                // Ê∏ÖÈô§‰πãÂâçÁöÑÂÆöÊó∂Âô®
                if (saveTimer) {
                  clearTimeout(saveTimer)
                }

                // 300ms ÂêéËá™Âä®‰øùÂ≠ò
                saveTimer = setTimeout(() => {
                  saveTodos()
                }, 300)
              },
              { deep: true }
            )

            // ÁõëÂê¨Á™óÂè£ÂÖ≥Èó≠Ââç‰∫ã‰ª∂
            window.addEventListener('beforeunload', handleBeforeUnload)

            console.log('‚úÖ Todo List Â∑≤Âä†ËΩΩ')
          })

          // ÊñπÊ≥ï
          async function loadData() {
            loading.value = true
            try {
              console.log('üîÑ ÂºÄÂßãÂä†ËΩΩÊï∞ÊçÆ...')

              // Ëé∑ÂèñÊèí‰ª∂‰ø°ÊÅØ
              if (window.pluginData) {
                pluginId.value = window.pluginData.pluginId
                pluginName.value = window.pluginData.pluginName || 'Todo List'
              }

              // ‰ªé‰∏ªËøõÁ®ãÂä†ËΩΩ‰ªªÂä°
              if (!window.api || !window.api.plugin) {
                console.error('‚ùå IPC API ‰∏çÂèØÁî®')
                todos.value = []
                return
              }

              const result = await window.api.plugin.invoke(`${pluginId.value}:getTodos`)

              if (result.success) {
                todos.value = result.data || []
                console.log(`‚úÖ ‰ªé‰∏ªËøõÁ®ãÂä†ËΩΩ‰∫Ü ${todos.value.length} ‰∏™‰ªªÂä°`)
                if (todos.value.length > 0) {
                  console.log('‰ªªÂä°ÂàóË°®:', todos.value.map((t) => t.text).join(', '))
                }
              } else {
                console.error('‚ùå Âä†ËΩΩ‰ªªÂä°Â§±Ë¥•:', result.error)
                todos.value = []
              }
            } catch (error) {
              console.error('‚ùå Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•:', error)
              todos.value = []
            } finally {
              loading.value = false
              console.log('‚úÖ Êï∞ÊçÆÂä†ËΩΩÂÆåÊàê')
            }
          }

          /**
           * ‰øùÂ≠ò‰ªªÂä°Âà∞‰∏ªËøõÁ®ã
           */
          async function saveTodos() {
            // Èò≤Ê≠¢Âπ∂Âèë‰øùÂ≠ò
            if (isSaving) {
              console.log('‚è≥ Ê≠£Âú®‰øùÂ≠òÔºåË∑≥ËøáÊú¨Ê¨°‰øùÂ≠ò')
              return
            }

            try {
              isSaving = true

              if (!window.api || !window.api.plugin) {
                console.error('‚ùå IPC API ‰∏çÂèØÁî®')
                return
              }

              // Ê∑±Êã∑Ë¥ù‰ªªÂä°Êï∞ÊçÆÔºåÁ°Æ‰øùÊï∞ÊçÆÂÆåÊï¥ÊÄß
              const todosToSave = JSON.parse(JSON.stringify(todos.value))

              const result = await window.api.plugin.invoke(
                `${pluginId.value}:saveTodos`,
                todosToSave
              )

              if (result.success) {
                console.log(`üíæ ‰ªªÂä°Â∑≤‰øùÂ≠ò: ${todos.value.length} Êù°`)
              } else {
                console.error('‚ùå ‰øùÂ≠ò‰ªªÂä°Â§±Ë¥•:', result.error)
                alert('‰øùÂ≠òÂ§±Ë¥•: ' + result.error)
              }
            } catch (error) {
              console.error('‚ùå ‰øùÂ≠ò‰ªªÂä°Â§±Ë¥•:', error)
              alert('‰øùÂ≠òÂ§±Ë¥•: ' + error.message)
            } finally {
              isSaving = false
            }
          }

          /**
           * Á™óÂè£ÂÖ≥Èó≠Ââç‰øùÂ≠ò
           */
          function handleBeforeUnload(event) {
            saveTodos()
          }

          async function toggleTodo(todoId) {
            try {
              const todo = todos.value.find((t) => t.id === todoId)
              if (!todo) return

              // ÂàáÊç¢Áä∂ÊÄÅ
              todo.completed = !todo.completed
              todo.updatedAt = new Date().toISOString()

              // ÂèëÈÄÅÈÄöÁü•
              if (window.api && window.api.plugin) {
                try {
                  await window.api.plugin.invoke('todo-list:notifyTaskToggled', {
                    text: todo.text,
                    completed: todo.completed
                  })
                } catch (notifyError) {
                  console.warn('ÂèëÈÄÅÈÄöÁü•Â§±Ë¥•:', notifyError)
                }
              }
            } catch (error) {
              console.error('ÂàáÊç¢‰ªªÂä°Áä∂ÊÄÅÂ§±Ë¥•:', error)
            }
          }

          async function deleteTodo(todoId) {
            if (!confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™‰ªªÂä°ÂêóÔºü')) return

            try {
              // Áõ¥Êé•‰ªéÂàóË°®‰∏≠Âà†Èô§Ôºà‰ºöËá™Âä®Ëß¶Âèë watch ‰øùÂ≠òÔºâ
              todos.value = todos.value.filter((t) => t.id !== todoId)
            } catch (error) {
              console.error('Âà†Èô§‰ªªÂä°Â§±Ë¥•:', error)
            }
          }

          async function clearCompleted() {
            const count = completedCount.value
            if (!confirm(`Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ ${count} ‰∏™Â∑≤ÂÆåÊàêÁöÑ‰ªªÂä°ÂêóÔºü`)) return

            try {
              // ËøáÊª§ÊéâÂ∑≤ÂÆåÊàêÁöÑ‰ªªÂä°Ôºà‰ºöËá™Âä®Ëß¶Âèë watch ‰øùÂ≠òÔºâ
              todos.value = todos.value.filter((t) => !t.completed)

              // ÂèëÈÄÅÈÄöÁü•
              if (window.api && window.api.plugin) {
                try {
                  await window.api.plugin.invoke('todo-list:notifyCleared', count)
                } catch (notifyError) {
                  console.warn('ÂèëÈÄÅÈÄöÁü•Â§±Ë¥•:', notifyError)
                }
              }
            } catch (error) {
              console.error('Ê∏ÖÁ©∫Â∑≤ÂÆåÊàê‰ªªÂä°Â§±Ë¥•:', error)
            }
          }

          /**
           * ÊâìÂºÄÊ∑ªÂä†‰ªªÂä°Dialog
           */
          function openAddDialog() {
            dialogMode.value = 'add'
            editingTodoId.value = null
            todoText.value = ''
            todoPriority.value = 'medium'
            todoDueDate.value = ''
            todoNotes.value = ''

            if (todoDialog.value) {
              todoDialog.value.showModal()
              nextTick(() => {
                if (dialogInput.value) {
                  dialogInput.value.focus()
                }
              })
            }
          }

          /**
           * ÊâìÂºÄÁºñËæë‰ªªÂä°Dialog
           */
          function openEditDialog(todo) {
            dialogMode.value = 'edit'
            editingTodoId.value = todo.id
            todoText.value = todo.text
            todoPriority.value = todo.priority
            todoDueDate.value = todo.dueDate || ''
            todoNotes.value = todo.notes || ''

            if (todoDialog.value) {
              todoDialog.value.showModal()
              nextTick(() => {
                if (dialogInput.value) {
                  dialogInput.value.focus()
                }
              })
            }
          }

          /**
           * ÂÖ≥Èó≠Dialog
           */
          function closeTodoDialog() {
            if (todoDialog.value) {
              todoDialog.value.close()
            }
            // Ê∏ÖÁ©∫Êï∞ÊçÆ
            editingTodoId.value = null
            todoText.value = ''
            todoPriority.value = 'medium'
            todoDueDate.value = ''
            todoNotes.value = ''
          }

          /**
           * Â§ÑÁêÜDialogÁÇπÂáª‰∫ã‰ª∂ÔºàÁÇπÂáªÂ§ñÈÉ®ÂÖ≥Èó≠Ôºâ
           */
          function handleDialogClick(event) {
            if (event.target === todoDialog.value) {
              closeTodoDialog()
            }
          }

          /**
           * ‰ªéDialog‰øùÂ≠ò‰ªªÂä°ÔºàÊ∑ªÂä†ÊàñÁºñËæëÔºâ
           */
          async function saveTodoFromDialog() {
            const text = todoText.value.trim()
            if (!text) return

            try {
              if (dialogMode.value === 'add') {
                // Ê∑ªÂä†Êñ∞‰ªªÂä°
                const newTodo = {
                  id: Date.now().toString(),
                  text: text,
                  completed: false,
                  priority: todoPriority.value,
                  dueDate: todoDueDate.value || null,
                  notes: todoNotes.value.trim() || null,
                  createdAt: new Date().toISOString(),
                  updatedAt: new Date().toISOString()
                }

                todos.value.push(newTodo)
                console.log(`‚ûï Ê∑ªÂä†‰ªªÂä°: ${text}`)

                // ÂèëÈÄÅÈÄöÁü•
                if (window.api && window.api.plugin) {
                  try {
                    await window.api.plugin.invoke('todo-list:notifyTaskAdded', {
                      text: newTodo.text
                    })
                  } catch (notifyError) {
                    console.warn('‚ö†Ô∏è  ÂèëÈÄÅÈÄöÁü•Â§±Ë¥•:', notifyError)
                  }
                }
              } else {
                // ÁºñËæëÁé∞Êúâ‰ªªÂä°
                const todo = todos.value.find((t) => t.id === editingTodoId.value)
                if (!todo) return

                todo.text = text
                todo.priority = todoPriority.value
                todo.dueDate = todoDueDate.value || null
                todo.notes = todoNotes.value.trim() || null
                todo.updatedAt = new Date().toISOString()

                console.log(`üìù ÁºñËæë‰ªªÂä°: ${text}`)
              }

              // ÂÖ≥Èó≠Dialog
              closeTodoDialog()
            } catch (error) {
              console.error('‚ùå ‰øùÂ≠ò‰ªªÂä°Â§±Ë¥•:', error)
              alert('‰øùÂ≠ò‰ªªÂä°Â§±Ë¥•: ' + error.message)
            }
          }

          function getPriorityLabel(priority) {
            const p = priorities.find((p) => p.value === priority)
            return p ? p.label : ''
          }

          function formatDate(dateString) {
            const date = new Date(dateString)
            const now = new Date()
            const diff = now - date

            // Â∞è‰∫é1ÂàÜÈíü
            if (diff < 60000) {
              return 'ÂàöÂàö'
            }

            // Â∞è‰∫é1Â∞èÊó∂
            if (diff < 3600000) {
              const minutes = Math.floor(diff / 60000)
              return `${minutes} ÂàÜÈíüÂâç`
            }

            // Â∞è‰∫é1Â§©
            if (diff < 86400000) {
              const hours = Math.floor(diff / 3600000)
              return `${hours} Â∞èÊó∂Ââç`
            }

            // Â∞è‰∫é7Â§©
            if (diff < 604800000) {
              const days = Math.floor(diff / 86400000)
              return `${days} Â§©Ââç`
            }

            // Ê†ºÂºèÂåñÊó•Êúü
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`
          }

          /**
           * Ëé∑Âèñ‰ªäÂ§©ÁöÑÊó•ÊúüÔºàYYYY-MM-DD Ê†ºÂºèÔºâ
           */
          function getTodayDate() {
            const today = new Date()
            return `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`
          }

          /**
           * Ê†ºÂºèÂåñÊà™Ê≠¢Êó•Êúü
           */
          function formatDueDate(dateString) {
            if (!dateString) return ''

            const dueDate = new Date(dateString)
            const today = new Date()
            today.setHours(0, 0, 0, 0)
            dueDate.setHours(0, 0, 0, 0)

            const diffTime = dueDate.getTime() - today.getTime()
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))

            if (diffDays < 0) {
              return `Â∑≤ËøáÊúü ${Math.abs(diffDays)} Â§©`
            } else if (diffDays === 0) {
              return '‰ªäÂ§©Âà∞Êúü'
            } else if (diffDays === 1) {
              return 'ÊòéÂ§©Âà∞Êúü'
            } else if (diffDays <= 7) {
              return `${diffDays} Â§©ÂêéÂà∞Êúü`
            } else {
              const month = dueDate.getMonth() + 1
              const day = dueDate.getDate()
              return `${month}Êúà${day}Êó•Âà∞Êúü`
            }
          }

          /**
           * Ëé∑ÂèñÊà™Ê≠¢Êó•ÊúüÁöÑCSSÁ±ªÂêç
           */
          function getDueDateClass(dateString, isCompleted) {
            if (!dateString || isCompleted) return ''

            const dueDate = new Date(dateString)
            const today = new Date()
            today.setHours(0, 0, 0, 0)
            dueDate.setHours(0, 0, 0, 0)

            const diffTime = dueDate.getTime() - today.getTime()
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24))

            if (diffDays < 0) {
              return 'overdue' // Â∑≤ËøáÊúü
            } else if (diffDays === 0) {
              return 'today' // ‰ªäÂ§©
            } else if (diffDays <= 3) {
              return 'upcoming' // Âç≥Â∞ÜÂà∞Êúü
            }
            return ''
          }

          return {
            pluginName,
            loading,
            todos,
            currentFilter,
            searchQuery,
            dialogMode,
            editingTodoId,
            todoText,
            todoPriority,
            todoDueDate,
            todoNotes,
            todoDialog,
            dialogInput,
            filters,
            priorities,
            totalCount,
            activeCount,
            completedCount,
            completionRate,
            filteredTodos,
            emptyMessage,
            toggleTodo,
            deleteTodo,
            clearCompleted,
            openAddDialog,
            openEditDialog,
            closeTodoDialog,
            handleDialogClick,
            saveTodoFromDialog,
            getPriorityLabel,
            formatDate,
            getTodayDate,
            formatDueDate,
            getDueDateClass
          }
        }
      }).mount('#app')
    </script>
  </body>
</html>
