<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¸¸ç”¨è¯­é€Ÿè®°</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        /* 2025 è‡ªç„¶é…è‰²ç³»ç»Ÿ */
        --primary-color: #6366f1;
        --primary-light: #818cf8;
        --primary-dark: #4f46e5;
        --accent-color: #06b6d4;
        --accent-light: #22d3ee;
        --success-color: #10b981;
        --danger-color: #ef4444;
        --warning-color: #f59e0b;

        /* åˆ†ç±»é¢œè‰² */
        --cat-work: #6366f1;
        --cat-life: #10b981;
        --cat-email: #f59e0b;
        --cat-social: #ec4899;
        --cat-other: #64748b;

        /* æ–‡å­—è‰²é˜¶ */
        --text-primary: #0f172a;
        --text-secondary: #475569;
        --text-tertiary: #94a3b8;
        --text-light: #cbd5e1;

        /* èƒŒæ™¯è‰²é˜¶ */
        --bg-primary: #ffffff;
        --bg-secondary: #f8fafc;
        --bg-tertiary: #f1f5f9;
        --bg-glass: rgba(255, 255, 255, 0.85);

        /* è¾¹æ¡† */
        --border-color: #e2e8f0;
        --border-subtle: #f1f5f9;

        /* é˜´å½±ç³»ç»Ÿ */
        --shadow-subtle: 0 1px 2px rgba(0, 0, 0, 0.04), 0 1px 3px rgba(0, 0, 0, 0.02);
        --shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.04), 0 4px 16px rgba(0, 0, 0, 0.03);
        --shadow-medium: 0 4px 16px rgba(0, 0, 0, 0.06), 0 8px 24px rgba(0, 0, 0, 0.04);
        --shadow-large: 0 8px 32px rgba(0, 0, 0, 0.08), 0 12px 48px rgba(0, 0, 0, 0.06);

        /* åœ†è§’ç³»ç»Ÿ */
        --radius-sm: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 20px;
        --radius-curved: 24px;
      }

      body {
        font-family:
          'SF Pro Display',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          'Inter',
          sans-serif;
        background: linear-gradient(135deg, #e0f2fe 0%, #f0fdf4 50%, #fef3c7 100%);
        min-height: 100vh;
        padding: 20px;
        color: var(--text-primary);
        position: relative;
      }

      /* å™ªç‚¹çº¹ç†å±‚ */
      body::before {
        content: '';
        position: fixed;
        top: -50%;
        left: -50%;
        right: -50%;
        bottom: -50%;
        width: 200%;
        height: 200%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' /%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.03'/%3E%3C/svg%3E");
        opacity: 0.5;
        pointer-events: none;
      }

      #app {
        max-width: 900px;
        margin: 0 auto;
        background: var(--bg-glass);
        backdrop-filter: blur(24px) saturate(180%);
        -webkit-backdrop-filter: blur(24px) saturate(180%);
        border-radius: var(--radius-curved);
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: var(--shadow-large);
        overflow: hidden;
        display: flex;
        flex-direction: column;
        height: calc(100vh - 40px);
        position: relative;
      }

      /* å¤´éƒ¨ */
      .header {
        padding: 12px 20px;
        border-bottom: 1px solid var(--border-subtle);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-shrink: 0;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.03) 0%, rgba(6, 182, 212, 0.03) 100%);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .header h1 {
        font-size: 18px;
        font-weight: 700;
        color: var(--text-primary);
        letter-spacing: -0.02em;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .header h1::before {
        content: '';
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
        box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
      }

      .header-badge {
        font-size: 10px;
        color: var(--text-tertiary);
        font-weight: 500;
      }

      .header-stats {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .stat-item {
        text-align: center;
        background: white;
        padding: 6px 10px;
        border-radius: var(--radius-md);
        border: 1px solid var(--border-color);
        box-shadow: var(--shadow-subtle);
      }

      .stat-item .count {
        font-size: 16px;
        font-weight: 700;
        color: var(--primary-color);
      }

      .stat-item .label {
        font-size: 10px;
        color: var(--text-tertiary);
        margin-top: 2px;
      }

      /* æœç´¢å’Œè¿‡æ»¤åŒºåŸŸ */
      .toolbar {
        padding: 12px 20px;
        border-bottom: 1px solid var(--border-subtle);
        display: flex;
        flex-direction: column;
        gap: 10px;
        flex-shrink: 0;
        background: var(--bg-secondary);
      }

      .search-row {
        display: flex;
        gap: 10px;
        align-items: center;
        flex-wrap: nowrap;
      }

      .search-box {
        flex: 1;
        position: relative;
      }

      .search-box input {
        width: 100%;
        padding: 8px 14px 8px 38px;
        border: 2px solid var(--border-color);
        border-radius: var(--radius-lg);
        font-size: 13px;
        background: white;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        outline: none;
      }

      .search-box input:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .search-box input::placeholder {
        color: var(--text-light);
      }

      .search-box::before {
        content: 'ğŸ”';
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 13px;
        opacity: 0.5;
      }

      .btn-add {
        height: 34px;
        padding: 0 12px;
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
        color: white;
        border: none;
        border-radius: var(--radius-lg);
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
        white-space: nowrap;
      }

      .btn-add:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(99, 102, 241, 0.4);
      }

      .btn-add:active {
        transform: translateY(0);
      }

      /* åˆ†ç±»é€‰æ‹©å™¨ï¼ˆæ›¿ä»£ chipsï¼šæ›´çœç©ºé—´ä¸”å½»åº•é¿å…è£åˆ‡ï¼‰ */
      .category-select {
        position: relative;
        flex: 0 0 auto;
      }

      .category-select select {
        height: 34px;
        width: 96px;
        padding: 0 28px 0 12px;
        border: 2px solid var(--border-color);
        border-radius: var(--radius-lg);
        background: white;
        color: var(--text-secondary);
        font-size: 13px;
        font-weight: 600;
        outline: none;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        cursor: pointer;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      .category-select select:hover {
        border-color: rgba(99, 102, 241, 0.35);
      }

      .category-select select:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .category-select::after {
        content: 'â–¾';
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 12px;
        color: var(--text-tertiary);
        pointer-events: none;
      }

      /* å†…å®¹åŒºåŸŸ */
      .content {
        flex: 1;
        overflow-y: auto;
        padding: 20px 28px;
      }

      /* å¸¸ç”¨è¯­åˆ—è¡¨ */
      .phrases-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      /* è¿‡æ¸¡åŠ¨ç”» */
      .phrase-list-enter-active {
        transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .phrase-list-leave-active {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .phrase-list-enter-from {
        opacity: 0;
        transform: scale(0.9) translateY(-10px);
      }

      .phrase-list-leave-to {
        opacity: 0;
        transform: scale(0.9);
      }

      .phrase-list-move {
        transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .phrase-row {
        background: white;
        border: 1px solid var(--border-color);
        border-radius: var(--radius-lg);
        padding: 10px 12px 10px 14px;
        cursor: pointer;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        user-select: none;
        display: flex;
        align-items: center;
        gap: 10px;
        min-height: 44px;
      }

      .phrase-row::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 3px;
        height: 100%;
        opacity: 0.8;
        transition: width 0.2s;
      }

      .phrase-row.work::before {
        background: var(--cat-work);
      }

      .phrase-row.life::before {
        background: var(--cat-life);
      }

      .phrase-row.email::before {
        background: var(--cat-email);
      }

      .phrase-row.social::before {
        background: var(--cat-social);
      }

      .phrase-row.other::before {
        background: var(--cat-other);
      }

      .phrase-row:hover {
        border-color: var(--primary-light);
        box-shadow: var(--shadow-soft);
        transform: translateY(-1px);
      }

      .phrase-row:hover::before {
        width: 4px;
      }

      .phrase-row.copying {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
        border-color: var(--success-color);
      }

      .phrase-category {
        font-size: 10px;
        font-weight: 600;
        padding: 4px 8px;
        border-radius: 6px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        flex-shrink: 0;
      }

      .phrase-category.work {
        background: rgba(99, 102, 241, 0.1);
        color: var(--cat-work);
      }

      .phrase-category.life {
        background: rgba(16, 185, 129, 0.1);
        color: var(--cat-life);
      }

      .phrase-category.email {
        background: rgba(245, 158, 11, 0.1);
        color: var(--cat-email);
      }

      .phrase-category.social {
        background: rgba(236, 72, 153, 0.1);
        color: var(--cat-social);
      }

      .phrase-category.other {
        background: rgba(100, 116, 139, 0.1);
        color: var(--cat-other);
      }

      .phrase-actions {
        display: flex;
        gap: 6px;
        opacity: 0;
        transition: opacity 0.2s;
        flex-shrink: 0;
      }

      .phrase-row:hover .phrase-actions {
        opacity: 1;
      }

      .phrase-actions button {
        width: 28px;
        height: 28px;
        border-radius: var(--radius-sm);
        border: none;
        background: var(--bg-tertiary);
        color: var(--text-tertiary);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        transition: all 0.2s;
      }

      .phrase-actions button:hover {
        background: var(--primary-color);
        color: white;
      }

      .phrase-actions button.delete:hover {
        background: var(--danger-color);
      }

      .phrase-content {
        font-size: 14px;
        line-height: 1.35;
        color: var(--text-primary);
        flex: 1;
        min-width: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        overflow: hidden;
      }

      /* ç©ºçŠ¶æ€ */
      .empty-state {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 60px 40px;
        text-align: center;
      }

      .empty-state-icon {
        width: 80px;
        height: 80px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
        border-radius: 50%;
        font-size: 36px;
      }

      .empty-state-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-secondary);
        margin-bottom: 8px;
      }

      .empty-state-text {
        font-size: 14px;
        color: var(--text-tertiary);
        max-width: 300px;
      }

      /* ç¼–è¾‘æ¨¡æ€æ¡† */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(15, 23, 42, 0.5);
        backdrop-filter: blur(4px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        padding: 20px;
      }

      .modal {
        background: white;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-large);
        width: 100%;
        max-width: 500px;
        overflow: hidden;
        animation: modalIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes modalIn {
        from {
          opacity: 0;
          transform: scale(0.95) translateY(10px);
        }
        to {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }

      .modal-header {
        padding: 20px 24px;
        border-bottom: 1px solid var(--border-subtle);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h2 {
        font-size: 18px;
        font-weight: 700;
        color: var(--text-primary);
      }

      .modal-close {
        width: 32px;
        height: 32px;
        border-radius: var(--radius-sm);
        border: none;
        background: var(--bg-tertiary);
        color: var(--text-tertiary);
        cursor: pointer;
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
      }

      .modal-close:hover {
        background: var(--danger-color);
        color: white;
      }

      .modal-body {
        padding: 24px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        font-size: 13px;
        font-weight: 600;
        color: var(--text-secondary);
        margin-bottom: 8px;
      }

      .form-group textarea,
      .form-group select {
        width: 100%;
        padding: 12px 14px;
        border: 2px solid var(--border-color);
        border-radius: var(--radius-md);
        font-size: 14px;
        font-family: inherit;
        transition: all 0.25s;
        outline: none;
        background: white;
      }

      .form-group textarea {
        min-height: 120px;
        resize: vertical;
        line-height: 1.6;
      }

      .form-group textarea:focus,
      .form-group select:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      }

      .form-group textarea::placeholder {
        color: var(--text-light);
      }

      .modal-footer {
        padding: 16px 24px;
        border-top: 1px solid var(--border-subtle);
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        background: var(--bg-secondary);
      }

      .btn {
        padding: 10px 20px;
        border-radius: var(--radius-md);
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        border: none;
      }

      .btn-secondary {
        background: var(--bg-tertiary);
        color: var(--text-secondary);
      }

      .btn-secondary:hover {
        background: #e2e8f0;
      }

      .btn-primary {
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
        color: white;
        box-shadow: 0 2px 8px rgba(99, 102, 241, 0.3);
      }

      .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(99, 102, 241, 0.4);
      }

      /* å¤åˆ¶æˆåŠŸæç¤º */
      .toast {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: linear-gradient(135deg, var(--success-color) 0%, #059669 100%);
        color: white;
        padding: 12px 24px;
        border-radius: var(--radius-lg);
        font-size: 14px;
        font-weight: 600;
        box-shadow: 0 4px 20px rgba(16, 185, 129, 0.4);
        z-index: 2000;
        display: flex;
        align-items: center;
        gap: 10px;
        opacity: 0;
        transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }

      .toast-icon {
        font-size: 18px;
      }

      /* æ»šåŠ¨æ¡ */
      ::-webkit-scrollbar {
        width: 6px;
      }

      ::-webkit-scrollbar-track {
        background: transparent;
      }

      ::-webkit-scrollbar-thumb {
        background: var(--text-light);
        border-radius: var(--radius-sm);
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--text-tertiary);
      }

      /* é€‰ä¸­æ–‡æœ¬æ ·å¼ */
      ::selection {
        background: rgba(99, 102, 241, 0.15);
        color: var(--text-primary);
      }

      /* å“åº”å¼ */
      @media (max-width: 768px) {
        body {
          padding: 12px;
        }

        #app {
          height: calc(100vh - 24px);
        }

        .header {
          padding: 10px 16px;
        }

        .header h1 {
          font-size: 16px;
        }

        .toolbar {
          padding: 10px 16px;
        }

        .content {
          padding: 12px 16px;
        }

        .phrases-list {
          gap: 10px;
        }

        .search-row {
          gap: 8px;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- å¤´éƒ¨ -->
      <div class="header">
        <div class="header-left">
          <h1>{{ pluginName }}</h1>
          <span class="header-badge">v{{ version }}</span>
        </div>
        <div class="header-stats">
          <div class="stat-item">
            <div class="count">{{ filteredPhrases.length }}</div>
            <div class="label">æ¡å¸¸ç”¨è¯­</div>
          </div>
        </div>
      </div>

      <!-- å·¥å…·æ  -->
      <div class="toolbar">
        <div class="search-row">
          <div class="search-box">
            <input
              type="text"
              v-model="searchQuery"
              placeholder="æœç´¢å¸¸ç”¨è¯­..."
              @input="onSearch"
            />
          </div>

          <div class="category-select" title="åˆ†ç±»">
            <select v-model="activeCategory">
              <option value="all">å…¨éƒ¨</option>
              <option v-for="cat in categories" :key="cat" :value="cat">{{ cat }}</option>
            </select>
          </div>

          <button class="btn-add" @click="openAddModal">
            <span style="font-size: 16px">+</span>
          </button>
        </div>
      </div>

      <!-- å†…å®¹åŒºåŸŸ -->
      <div class="content">
        <!-- å¸¸ç”¨è¯­åˆ—è¡¨ -->
        <div v-if="filteredPhrases.length > 0" class="phrases-list">
          <transition-group name="phrase-list">
            <div
              v-for="phrase in filteredPhrases"
              :key="phrase.id"
              :class="['phrase-row', getCategoryClass(phrase.category), { copying: copyingId === phrase.id }]"
              @dblclick="copyPhrase(phrase)"
              :title="phrase.content"
            >
              <span :class="['phrase-category', getCategoryClass(phrase.category)]">
                {{ phrase.category }}
              </span>

              <div class="phrase-content">{{ phrase.content }}</div>

              <div class="phrase-actions">
                <button @click.stop="openEditModal(phrase)" title="ç¼–è¾‘">âœï¸</button>
                <button class="delete" @click.stop="deletePhrase(phrase)" title="åˆ é™¤">ğŸ—‘ï¸</button>
              </div>
            </div>
          </transition-group>
        </div>

        <!-- ç©ºçŠ¶æ€ -->
        <div v-else class="empty-state">
          <div class="empty-state-icon">ğŸ“‹</div>
          <div class="empty-state-title">
            {{ searchQuery || activeCategory !== 'all' ? 'æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¸¸ç”¨è¯­' : 'è¿˜æ²¡æœ‰å¸¸ç”¨è¯­' }}
          </div>
          <div class="empty-state-text">
            {{ searchQuery || activeCategory !== 'all' ? 'è¯•è¯•å…¶ä»–æœç´¢è¯æˆ–åˆ†ç±»' : 'ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ·»åŠ ä½ çš„ç¬¬ä¸€æ¡å¸¸ç”¨è¯­' }}
          </div>
        </div>
      </div>

      <!-- ç¼–è¾‘/æ·»åŠ æ¨¡æ€æ¡† -->
      <div v-if="showModal" class="modal-overlay" @click.self="closeModal">
        <div class="modal">
          <div class="modal-header">
            <h2>{{ isEditing ? 'ç¼–è¾‘å¸¸ç”¨è¯­' : 'æ·»åŠ å¸¸ç”¨è¯­' }}</h2>
            <button class="modal-close" @click="closeModal">Ã—</button>
          </div>

          <div class="modal-body">
            <div class="form-group">
              <label>å¸¸ç”¨è¯­å†…å®¹ *</label>
              <textarea
                v-model="editForm.content"
                placeholder="è¾“å…¥ä½ çš„å¸¸ç”¨è¯­å†…å®¹ï¼Œæ”¯æŒå¤šè¡Œ..."
                rows="5"
              ></textarea>
            </div>

            <div class="form-group">
              <label>åˆ†ç±»</label>
              <select v-model="editForm.category">
                <option v-for="cat in categories" :key="cat" :value="cat">
                  {{ cat }}
                </option>
              </select>
            </div>
          </div>

          <div class="modal-footer">
            <button class="btn btn-secondary" @click="closeModal">å–æ¶ˆ</button>
            <button class="btn btn-primary" @click="savePhrase" :disabled="!editForm.content.trim()">
              {{ isEditing ? 'ä¿å­˜' : 'æ·»åŠ ' }}
            </button>
          </div>
        </div>
      </div>

      <!-- å¤åˆ¶æˆåŠŸæç¤º -->
      <div :class="['toast', { show: showToast }]">
        <span class="toast-icon">âœ“</span>
        <span>å·²å¤åˆ¶åˆ°å‰ªåˆ‡æ¿</span>
      </div>
    </div>

    <!-- å¼•å…¥ Vue 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script>
      const { createApp, ref, reactive, computed, onMounted, onUnmounted } = Vue

      createApp({
        setup() {
          // çŠ¶æ€
          const pluginId = ref('')
          const pluginName = ref('å¸¸ç”¨è¯­é€Ÿè®°')
          const version = ref('1.0.0')
          const phrases = ref([])
          const categories = ref(['å·¥ä½œ', 'ç”Ÿæ´»', 'é‚®ä»¶', 'ç¤¾äº¤', 'å…¶ä»–'])
          const searchQuery = ref('')
          const activeCategory = ref('all')
          const showModal = ref(false)
          const isEditing = ref(false)
          const copyingId = ref(null)
          const showToast = ref(false)

          const editForm = reactive({
            id: null,
            content: '',
            category: 'å…¶ä»–'
          })

          // è®¡ç®—å±æ€§ - è¿‡æ»¤åçš„å¸¸ç”¨è¯­
          const filteredPhrases = computed(() => {
            let result = [...phrases.value]

            // åˆ†ç±»è¿‡æ»¤
            if (activeCategory.value !== 'all') {
              result = result.filter(p => p.category === activeCategory.value)
            }

            // æœç´¢è¿‡æ»¤
            if (searchQuery.value.trim()) {
              const query = searchQuery.value.toLowerCase().trim()
              result = result.filter(p =>
                p.content.toLowerCase().includes(query) ||
                p.category.toLowerCase().includes(query)
              )
            }

            // æŒ‰æ›´æ–°æ—¶é—´æ’åº
            return result.sort((a, b) => b.updatedAt - a.updatedAt)
          })

          // ç”Ÿå‘½å‘¨æœŸ
          onMounted(async () => {
            if (window.pluginData) {
              pluginId.value = window.pluginData.pluginId
              pluginName.value = window.pluginData.pluginName || 'å¸¸ç”¨è¯­é€Ÿè®°'
              version.value = window.pluginData.version || '1.0.0'
            }

            await loadPhrases()
            await loadCategories()

            console.log('âœ… å¸¸ç”¨è¯­é€Ÿè®°å·²åŠ è½½,å…±', phrases.value.length, 'æ¡')
          })

          // æ–¹æ³•

          async function loadPhrases() {
            try {
              if (!window.api?.plugin) return
              const result = await window.api.plugin.invoke(`${pluginId.value}:getPhrases`)
              if (result.success) {
                phrases.value = result.data || []
              }
            } catch (error) {
              console.error('åŠ è½½å¸¸ç”¨è¯­å¤±è´¥:', error)
            }
          }

          async function loadCategories() {
            try {
              if (!window.api?.plugin) return
              const result = await window.api.plugin.invoke(`${pluginId.value}:getCategories`)
              if (result.success && result.data?.length > 0) {
                categories.value = result.data
              }
            } catch (error) {
              console.error('åŠ è½½åˆ†ç±»å¤±è´¥:', error)
            }
          }

          async function savePhrases() {
            try {
              if (!window.api?.plugin) return
              const result = await window.api.plugin.invoke(
                `${pluginId.value}:savePhrases`,
                JSON.parse(JSON.stringify(phrases.value))
              )
              if (!result.success) {
                console.error('ä¿å­˜å¤±è´¥:', result.error)
              }
            } catch (error) {
              console.error('ä¿å­˜å¸¸ç”¨è¯­å¤±è´¥:', error)
            }
          }

          async function copyPhrase(phrase) {
            try {
              copyingId.value = phrase.id

              if (window.api?.plugin) {
                await window.api.plugin.invoke(
                  `${pluginId.value}:copyToClipboard`,
                  phrase.content
                )
              }

              // æ›´æ–°ä½¿ç”¨æ¬¡æ•°
              phrase.usageCount = (phrase.usageCount || 0) + 1
              phrase.updatedAt = Date.now()
              await savePhrases()

              // æ˜¾ç¤ºæç¤º
              showToast.value = true
              setTimeout(() => {
                showToast.value = false
              }, 2000)

              // æ¢å¤å¡ç‰‡çŠ¶æ€
              setTimeout(() => {
                copyingId.value = null
              }, 300)
            } catch (error) {
              console.error('å¤åˆ¶å¤±è´¥:', error)
              copyingId.value = null
            }
          }

          function openAddModal() {
            isEditing.value = false
            editForm.id = null
            editForm.content = ''
            editForm.category = categories.value[0] || 'å…¶ä»–'
            showModal.value = true
          }

          function openEditModal(phrase) {
            isEditing.value = true
            editForm.id = phrase.id
            editForm.content = phrase.content
            editForm.category = phrase.category
            showModal.value = true
          }

          function closeModal() {
            showModal.value = false
            editForm.id = null
            editForm.content = ''
            editForm.category = categories.value[0] || 'å…¶ä»–'
          }

          async function savePhrase() {
            if (!editForm.content.trim()) return

            const now = Date.now()

            if (isEditing.value && editForm.id) {
              // ç¼–è¾‘ç°æœ‰
              const index = phrases.value.findIndex(p => p.id === editForm.id)
              if (index !== -1) {
                phrases.value[index] = {
                  ...phrases.value[index],
                  content: editForm.content.trim(),
                  category: editForm.category,
                  updatedAt: now
                }
              }
            } else {
              // æ·»åŠ æ–°çš„
              phrases.value.push({
                id: 'phrase_' + now + '_' + Math.random().toString(36).substr(2, 9),
                content: editForm.content.trim(),
                category: editForm.category,
                createdAt: now,
                updatedAt: now,
                usageCount: 0
              })
            }

            await savePhrases()
            closeModal()
          }

          async function deletePhrase(phrase) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å¸¸ç”¨è¯­å—ï¼Ÿ')) return

            const index = phrases.value.findIndex(p => p.id === phrase.id)
            if (index !== -1) {
              phrases.value.splice(index, 1)
              await savePhrases()
            }
          }

          function setCategory(cat) {
            activeCategory.value = cat
          }

          function getCategoryClass(category) {
            const map = {
              'å·¥ä½œ': 'work',
              'ç”Ÿæ´»': 'life',
              'é‚®ä»¶': 'email',
              'ç¤¾äº¤': 'social',
              'å…¶ä»–': 'other'
            }
            return map[category] || 'other'
          }

          function formatTime(timestamp) {
            if (!timestamp) return ''
            const date = new Date(timestamp)
            const now = new Date()
            const diff = now - date

            if (diff < 60000) return 'åˆšåˆš'
            if (diff < 3600000) return Math.floor(diff / 60000) + 'åˆ†é’Ÿå‰'
            if (diff < 86400000) return Math.floor(diff / 3600000) + 'å°æ—¶å‰'
            if (diff < 604800000) return Math.floor(diff / 86400000) + 'å¤©å‰'

            return date.toLocaleDateString('zh-CN', {
              month: 'short',
              day: 'numeric'
            })
          }

          function onSearch() {
            // å®æ—¶æœç´¢,æ— éœ€é¢å¤–å¤„ç†
          }

          return {
            pluginName,
            version,
            phrases,
            categories,
            searchQuery,
            activeCategory,
            showModal,
            isEditing,
            editForm,
            copyingId,
            showToast,
            filteredPhrases,
            loadPhrases,
            copyPhrase,
            openAddModal,
            openEditModal,
            closeModal,
            savePhrase,
            deletePhrase,
            setCategory,
            getCategoryClass,
            formatTime,
            onSearch
          }
        }
      }).mount('#app')
    </script>
  </body>
</html>
